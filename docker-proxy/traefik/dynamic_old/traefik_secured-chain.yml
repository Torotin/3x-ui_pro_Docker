# /templates/traefik_secured-chain.yml
http:
  middlewares:
    # Оптимизированная цепочка middleware для защищенных роутеров
    secured-chain:
      chain:
        middlewares:
          - security-headers@file          # 1) заголовки безопасности
          - crowdsec-bouncer@file          # 2) защита от атак
          - compress@file                  # 3) сжатие контента
          - cache-static@file              # 4) кэширование (где применимо)

    # Легкая цепочка для API
    api-chain:
      chain:
        middlewares:
          - api-headers@file               # 1) базовые заголовки безопасности
          - crowdsec-bouncer@file          # 2) защита от атак
          - compress@file                  # 3) сжатие

    # Цепочка для статических файлов
    static-chain:
      chain:
        middlewares:
          - static-headers@file            # 1) заголовки для статики
          - cache-static@file              # 2) кэширование
          - compress@file                  # 3) сжатие