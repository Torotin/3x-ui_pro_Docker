# dynamic/traefik-dashboard.yml

http:
  middlewares:
    traefik-strip:
      stripPrefix:
        prefixes:
          - "${URI_TRAEFIK_DASHBOARD}"
    stats-auth:
      basicAuth:
        users:
          - "${HT_PASS_ENCODED}"

  routers:
    traefik-ui:
      rule: "Host(`${WEBDOMAIN}`) && PathPrefix(`/${URI_TRAEFIK_DASHBOARD}`)"
      entryPoints:
        - websecure
      middlewares:
        - traefik-strip
        - stats-auth
        - secured
      tls:
        certResolver: le
      service: api@internal

    traefik-api:
      rule: "Host(`${WEBDOMAIN}`) && PathPrefix(`/api`)"
      entryPoints:
        - websecure
      middlewares:
        - stats-auth
        - secured
      tls:
        certResolver: le
      service: api@internal
