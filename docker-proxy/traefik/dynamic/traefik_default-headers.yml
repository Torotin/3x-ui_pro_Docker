# /templates/default-headers.yml
http:
  middlewares:
    default-headers:
      headers:
        # --- TLS / HSTS ---
        sslRedirect: true                 # redundant if you already redirect web->websecure, but harmless
        stsSeconds: 63072000              # 2 years
        stsIncludeSubdomains: true        # be sure ALL subdomains are HTTPS before enabling
        stsPreload: true

        # --- MIME & XSS ---
        contentTypeNosniff: true
        browserXssFilter: true

        # --- Clickjacking ---
        frameDeny: true                   # X-Frame-Options: DENY

        # --- Referrer policy ---
        referrerPolicy: "no-referrer"

        # --- CORS ---
        accessControlAllowOriginList:
          - "https://${WEBDOMAIN}"
        accessControlAllowMethods:
          - GET
          - POST
          - OPTIONS
        accessControlAllowHeaders:
          - Origin
          - Content-Type
          - Accept
        accessControlAllowCredentials: true
        addVaryHeader: true
        accessControlMaxAge: 600

        # --- Extra hardening via raw headers (supported through customResponseHeaders) ---
        customResponseHeaders:
          # COOP / CORP (not exposed as dedicated fields in v3.5.0)
          Cross-Origin-Opener-Policy: "same-origin"
          Cross-Origin-Resource-Policy: "same-origin"
          # Permissions-Policy: disable powerful features by default
          server: ""
          Permissions-Policy: "accelerometer=(), camera=(), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), payment=(), usb=()"
          # (Optional) CSP in report-only to avoid breakage while testing
          # Content-Security-Policy-Report-Only: "default-src 'self'; img-src 'self' data:; object-src 'none'; base-uri 'self'; frame-ancestors 'none'"
